version: '3.8'

# EC2 deployment â€” worker + bgutil only
# API runs on Render (see render.yaml)

services:
  worker:
    build:
      context: .
      dockerfile: Dockerfile.worker
    ports:
      - "3002:3002"
    env_file:
      - .env
    environment:
      - NODE_ENV=production
      - YT_DLP_GET_POT_BGUTIL_BASE_URL=http://bgutil-provider:4416
    volumes:
      - ./config:/app/config
    depends_on:
      - bgutil-provider
    restart: unless-stopped

  bgutil-provider:
    image: brainicism/bgutil-ytdlp-pot-provider:latest
    ports:
      - "4416:4416"
    restart: unless-stopped
