services:
  api:
    build:
      context: .
      dockerfile: Dockerfile
    ports:
      - "3001:3001"
    env_file:
      - .env
    environment:
      - NODE_ENV=production
    volumes:
      - ./config:/app/config
    restart: unless-stopped

  worker:
    build:
      context: .
      dockerfile: Dockerfile.worker
    ports:
      - "3002:3002"
    env_file:
      - .env
    environment:
      - NODE_ENV=production
      - YT_DLP_GET_POT_BGUTIL_BASE_URL=http://bgutil-provider:4416
    volumes:
      - ./config:/app/config
    depends_on:
      - bgutil-provider
    restart: unless-stopped

  bgutil-provider:
    image: brainicism/bgutil-ytdlp-pot-provider:latest
    ports:
      - "4416:4416"
    restart: unless-stopped
